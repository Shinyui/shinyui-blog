---
title: è™•ç†è³‡æ–™ç¼ºå¤±å€¼çš„æ–¹æ³• â€” å®Œæ•´è³‡æ–™åˆ†æï¼ˆComplete Case Analysisï¼‰åŠ Pythonå¯¦ä½œ
description: è™•ç†è³‡æ–™ç¼ºå¤±å€¼çš„æ–¹æ³• â€” å®Œæ•´è³‡æ–™åˆ†æï¼ˆComplete Case Analysisï¼‰åŠ Pythonå¯¦ä½œ
slug: complete-case-analysis
date: 2020-09-03
type: Post
---

åœ¨è³‡æ–™åˆ†æï¼ˆData Analyticsï¼‰æˆ–æ˜¯æ©Ÿå™¨å­¸ç¿’ï¼ˆMachine Learningï¼‰å°ˆæ¡ˆçš„ç”Ÿå‘½é€±æœŸè£¡è£¡çš„è³‡æ–™æ¸…æ´—ï¼ˆData Cleaningï¼‰çµ•å°æ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚è€Œå…¶ä¸­æ‡‚å¾—è™•ç†è³‡æ–™ç¼ºå¤±å€¼ï¼ˆMissing Dataï¼‰çµ•å°æ˜¯å°ˆæ¡ˆæˆåŠŸçš„ä¸€å€‹é—œéµï¼è™•ç†è³‡æ–™ç¼ºå¤±å€¼çš„æ–¹æ³•æœ‰å¾ˆå¤šç¨®ï¼Œåœ¨é€™ç¯‡æ–‡ç« ä¸­æˆ‘å€‘æœƒä»‹ç´¹å…¶ä¸­æœ€å¸¸è¦‹çš„ä¸€ç¨®æ–¹æ³• â€” å®Œæ•´è³‡æ–™åˆ†æ(Complete Case Analysis)ä»¥åŠèƒŒå¾Œçš„ Python å¯¦ä½œï¼

![Source: [https://fi.pinterest.com/pin/811633164074731545/](https://fi.pinterest.com/pin/811633164074731545/)](https://cdn-images-1.medium.com/max/2000/1*FxeHc3X3WWmpPZ_B63mGag.jpeg)

åœ¨ä»Šå¤©å¯«é€™ç¯‡æ–‡ç« æ™‚ï¼Œé–±è®€åˆ°é€™ç¯‡æ–‡ç«  [Untold Truths of being a Machine Learning Engineer](https://towardsdatascience.com/untold-truths-of-being-a-machine-learning-engineer-364218db2317)ï¼Œç•¶ä¸­æåˆ°äº†æ©Ÿå™¨å­¸ç¿’å·¥ç¨‹å¸«æœƒèŠ±å¤šæ•¸çš„æ™‚é–“æŠŠè³‡æ–™è½‰æ›æˆèƒ½åæ‡‰å‡ºå¯¦éš›ç‹€æ³çš„è³‡æ–™ã€‚

> ML engineers spend most of the time working on â€œhow to properly extract the training set that will resemble real-world problem distributionâ€

åœ¨å¤šæ•¸çš„æƒ…æ³ä¸‹ï¼Œç•¶æˆ‘å€‘èƒ½**ç¢ºå¯¦**åšå¥½è³‡æ–™çš„é è™•ç†æ™‚ï¼Œå³ä¾¿ç”¨ä¸€èˆ¬çš„æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ä¹Ÿèƒ½é”æˆé‚„ä¸éŒ¯çš„æ•ˆæœã€‚

è€Œé€™ç¯‡æ–‡ç« ä¹Ÿå†æ¬¡èªªæ˜äº†è³‡æ–™é è™•ç†çš„é‡è¦æ€§ï¼

## ä»€éº¼æ˜¯å®Œæ•´è³‡æ–™åˆ†æï¼ˆComplete Case Analysisï¼‰ï¼Ÿ

å®Œæ•´è³‡æ–™åˆ†æï¼ˆCCAï¼‰çš„æ¦‚å¿µçœ‹èµ·ä¾†å¥½åƒå¾ˆè¤‡é›œï¼Œä½†æ˜¯åœ¨ Python ä¸Šçš„å¯¦è¸æˆ‘å€‘å¯ä»¥åˆ©ç”¨ Pandas çš„ä¸€å€‹æ–¹æ³•å°±èƒ½é”åˆ°ï¼Œè€Œä¸”æˆ‘æ‰“è³­ä½ ä¸€å®šçœ‹éé€™å€‹æ–¹æ³•ï¼

    df = df["tar_variable"].dropna()

æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Ÿæ²’éŒ¯ï¼Œå¦‚æœæˆ‘å€‘"Pandas"çš„ä¸€é»ä¾†èªªï¼Œå®Œæ•´è³‡æ–™åˆ†æå…¶å¯¦å°±åªæ˜¯æŠŠç¼ºå¤±çš„è³‡æ–™åˆªé™¤æ‰è€Œå·²ï¼

![å­¸ç¿’è™•ç†è³‡æ–™ç¼ºå¤±å€¼çš„æ–¹æ³•æ¢—åœ–](https://cdn-images-1.medium.com/max/2000/1*ZaizbqKoRZQderImKD4JBA.png)

é€™éº¼ç°¡å–®ï¼Ÿæ²’éŒ¯å°±æ˜¯é€™éº¼ç°¡å–®ï¼Ÿç°¡å–®çš„æ±è¥¿æˆ‘å€‘æ²’å¿…è¦æŠŠå®ƒè®Šå¾—è¤‡é›œå˜›ï¼å°å§ï¼ˆç•¶ç„¶è£ B é™¤å¤– ğŸ¤£ï¼‰ï¼Ÿ

## å®Œæ•´è³‡æ–™åˆ†æå‡è¨­åŠé©ç”¨æƒ…æ³

åœ¨å®Œæ•´è³‡æ–™åˆ†æä¸­çš„å‡è¨­æ˜¯è³‡æ–™çš„ç¼ºå¤±çš„æ¨¡å¼ï¼ˆPatternï¼‰å¿…é ˆæ˜¯éš¨æ©Ÿçš„ï¼Œæ›å¥ç¼ºå¤±è³‡æ–™çš„æ˜¯éš¨æ©Ÿï¼ˆRandomï¼‰çš„ä¹Ÿå°±æ˜¯**MCAR**ï¼ˆMissing Completely at Randomï¼‰ï¼Œ**ä¸èƒ½**æœ‰æŸç¨®çš„æ¨¡å¼å­˜åœ¨ã€‚

ç•¶ç„¶ä¸æ˜¯æ¯ç¨®ç¬¦åˆ MCAR çš„è®Šæ•¸éƒ½èƒ½å¯ä»¥ä½¿ç”¨ CCAï¼Œå‡å¦‚ç¼ºå¤±è³‡æ–™çš„æ¯”é‡å å¤ªå¤šï¼Œç›´æ¥æ¡ç”¨ CCA å¯èƒ½æœƒç ´å£ï¼ˆDistortï¼‰é‚£å€‹è®Šæ•¸çš„è³‡æ–™åˆ†å¸ƒç‹€æ…‹ï¼ˆData Distirbutionï¼‰ã€‚æ‰€ä»¥ç¼ºå¤±å€¼çš„æ¯”ä¾‹ä¸èƒ½å¤ªé«˜ï¼

é‚£ç¼ºå¤±å€¼çš„æ¯”ä¾‹è¶…éå¤šå°‘å°±ç®—é«˜å‘¢ï¼Ÿ10%ï¼Ÿ15%ï¼Ÿé‚„æ˜¯ 25%ï¼Ÿ

å…¶å¯¦åªè¦ç¼ºå¤±å€¼çš„æ¯”ä¾‹åªè¦è¶…é 5%å°±ä¸å»ºè­°æ¡ç”¨ CCAï¼Œæ›è¨€ä¹‹åªè¦ 5%ä»¥ä¸‹è€Œä¸”è³‡æ–™çš„ç¼ºå¤±æ˜¯éš¨æ©Ÿçš„å°±èƒ½ä½¿ç”¨ CCA å–”~~

## å®Œæ•´è³‡æ–™åˆ†æ Python å¯¦ä½œ

äº†è§£å®Œç†è«–å¾Œï¼Œæ¥è‘—æˆ‘å€‘è¦ä¾†å­¸ç¿’å¦‚ä½•åˆ©ç”¨ Python ä¾†åš CCAã€‚æˆ‘å€‘ä½¿ç”¨çš„è³‡æ–™é›†æ˜¯è‘—åçš„[Kaggle House Prices: Advanced Regression Techniques](https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data?select=train.csv)ç«¶è³½ï¼Œè³‡æ–™å¯ä»¥é€éä¸Šé¢çš„é€£çµå–å¾—ã€‚é †å¸¶ä¸€æï¼Œé€™å ´ç«¶è³½éå¸¸é©åˆæ–°æ‰‹ä½œç‚ºç¬¬ä¸€å ´çš„æ©Ÿå™¨å­¸ç¿’ç«¶è³½ï¼Œå¦‚æœèƒ½æ‰“é€²å…¨çƒå‰ 5%å°±å¾ˆä¸éŒ¯æƒ¹~~

å–”å°äº†ï¼Œæˆ‘å€‘æ˜¯æ‹¿è¨“ç·´é›†ä¾† demo è€Œä¸æ˜¯æ¸¬è©¦é›†å–”ï¼

é¦–å…ˆæˆ‘å€‘ import ä¸€äº›å¿…è¦çš„æ¨¡å¡Šé‚„æœ‰åˆ©ç”¨ Pandas è®€å–è³‡æ–™é›†ï¼Œç¨‹å¼ç¢¼çœ‹èµ·ä¾†æœƒåƒæ˜¯é€™æ¨£ã€‚

```Python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

data = pd.read_csv(â€œtrain.csvâ€)
data.head()
```

è¼¸å‡ºçµæœçœ‹èµ·ä¾†æœƒæ˜¯é•·é€™æ¨£

![data.head() è¼¸å‡ºçµæœ](https://cdn-images-1.medium.com/max/4820/1*Oog8aOFHzUTkqaYyV6EGSQ.png)

æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘è¦æ‰¾å‡ºé‚£äº›è‡ªè®Šæ•¸ï¼ˆæˆ–æ˜¯ç‰¹å¾µï¼‰æ˜¯æœ‰ç¼ºå€¼çš„ï¼Œç¨‹å¼ç¢¼çœ‹èµ·ä¾†æœƒåƒæ˜¯é€™æ¨£ã€‚

```Python
var_na = [col for col in df.columns if df[col].isnull().mean() > 0]
```

è¼¸å‡ºçµæœçœ‹èµ·ä¾†æœƒæ˜¯é•·é€™æ¨£

```Python
['LotFrontage','Alley','MasVnrType','MasVnrArea','BsmtQual','BsmtCond','BsmtExposure','BsmtFinType1','BsmtFinType2','Electrical','FireplaceQu','GarageType','GarageYrBlt','GarageFinish','GarageQual','GarageCond','PoolQC','Fence','MiscFeature']
```

ä½ å¯èƒ½æœ‰æ³¨æ„åˆ°æˆ‘ç¯©é¸å‡ºç¼ºå€¼çš„è®Šæ•¸æ‰€æ¡ç”¨çš„æ–¹æ³•æ˜¯ mean è€Œä¸æ˜¯ç”¨ sumï¼ŒåŸå› æ˜¯å› ç‚ºæˆ‘å€‘æƒ³è¦å¾—çŸ¥ç¼ºå€¼å è©²è®Šæ•¸çš„æ¯”ä¾‹ï¼Œè€Œ mean å¯ä»¥åšåˆ°é€™é»ã€‚ç•¶ç„¶æˆ‘å€‘ä¹Ÿæ˜¯å¯ä»¥ç”¨ç¼ºå€¼çš„æ•¸é‡é™¤ä»¥å…¨éƒ¨çš„æ•¸é‡ï¼Œä¸éå°±æœ‰é»å¤šæ­¤ä¸€èˆ‰ã€‚

é‚„è¨˜å¾—æˆ‘å€‘åœ¨ä¸Šä¸€æ®µæœ‰æåˆ°ç¼ºå€¼è¦å°æ–¼ 5%æ‰é©ç”¨ CCA å—ï¼Ÿæ¥è‘—æˆ‘å€‘è¦ä¾†ç¯©é¸å‡ºå°æ–¼ 5%çš„è®Šæ•¸ï¼Œå…·é«”è€Œè¨€æˆ‘å€‘å¯ä»¥åˆ©ç”¨ä»¥ä¸‹ç¨‹å¼ç¢¼é”æˆã€‚

```Python
cca_var = [var for var in df.columns if df[var].isnull().mean() < 0.05]
```

è¼¸å‡ºçµæœå‰‡æ˜¯

```Python
["Id","MSSubClass","MSZoning","LotArea","Street","LotShape","LandContour","Utilities","LotConfig","LandSlope","Neighborhood","Condition1","Condition2","BldgType","HouseStyle","OverallQual","OverallCond","YearBuilt","YearRemodAdd","RoofStyle","RoofMatl","Exterior1st","Exterior2nd","MasVnrType","MasVnrArea","ExterQual","ExterCond","Foundation","BsmtQual","BsmtCond","BsmtExposure","BsmtFinType1","BsmtFinSF1","BsmtFinType2","BsmtFinSF2","BsmtUnfSF","TotalBsmtSF","Heating","HeatingQC","CentralAir","Electrical","1stFlrSF","2ndFlrSF","LowQualFinSF","GrLivArea","BsmtFullBath","BsmtHalfBath","FullBath","HalfBath","BedroomAbvGr","KitchenAbvGr","KitchenQual","TotRmsAbvGrd","Functional","Fireplaces","GarageCars","GarageArea","PavedDrive","WoodDeckSF","OpenPorchSF","EnclosedPorch","3SsnPorch","ScreenPorch","PoolArea","MiscVal","MoSold","YrSold","SaleType","SaleCondition","SalePrice"];
```

æ¥è‘—æˆ‘å€‘è¦æŠŠä¸Šé¢é€™äº›è®Šæ•¸çš„ç¼ºå¤±å€¼å…¨éƒ¨ drop æ‰ï¼Œç¨‹å¼ç¢¼æœƒé•·é€™æ¨£

```Python
cca_df = df[cca_var].dropna()
```

æ¥è‘—çœ‹ä¸€ä¸‹å‰å¾Œç¸½å…±åˆªæ‰äº†å¤šå°‘è³‡æ–™

```Python
cca_df.shape[0], df.shape[0]
```

åŸ·è¡Œçµæœ

```Python
(1412, 1460)
```

æˆ‘å€‘ç¸½å…± drop æ‰äº† 48 ç­†è³‡æ–™

æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹ CCA å¾Œçš„è³‡æ–™è®Šå‹•ï¼Œæˆ‘å€‘æ‹¿ GrLivArea é€™å€‹è®Šæ•¸ç‚ºä¾‹ã€‚æˆ‘å€‘å¯ä»¥åˆ©ç”¨ä¸‹é¢é€™æ®µç¨‹å¼ç¢¼ä¾†çœ‹å¾ŒçºŒè®Šç•°çš„ç‹€æ³ã€‚

```Python
plt.hist(df[â€œGrLivAreaâ€], bins=50, color=â€redâ€, label=â€Originalâ€)
plt.hist(cca_df[â€œGrLivAreaâ€], bins=50, color=â€blueâ€, alpha=0.7, label=â€Afterâ€)
plt.legend();
```

è¼¸å‡ºçµæœæœƒé•·é€™æ¨£

![é–¥å€¼åœ¨å°æ–¼0.05æ™‚å®Œæ•´è³‡æ–™åˆ†æ(CCA)å‰å¾Œå°æ¯”](https://cdn-images-1.medium.com/max/2836/1*UYGdy8xuwY4lOBG9yZO0EA.png)

æˆ‘å€‘å¯ä»¥çœ‹åˆ°æ•´é«”è³‡æ–™çš„åˆ†å¸ƒä¸¦æ²’æœ‰è®Šå¤ªå¤šï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æˆ‘å€‘è¦è¨­ 0.05 çš„åŸå› ï¼Œå¦‚æœè¨­å¤ªé«˜è­¬å¦‚æ˜¯â€¦â€¦ 0.65 å¥½äº†ï¼Œè³‡æ–™çœ‹èµ·ä¾†æœƒåƒæ˜¯é€™æ¨£ã€‚

![é–¥å€¼åœ¨å°æ–¼0.65æ™‚å®Œæ•´è³‡æ–™åˆ†æ(CCA)å‰å¾Œå°æ¯”](https://cdn-images-1.medium.com/max/2840/1*9bZQje0x3S1Mwn8oY7_cJg.png)

ç›¸è¼ƒä¸Šä¸€å¼µåœ–ï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°è³‡æ–™æœ‰äº†å¾ˆåŠ‡çƒˆçš„æ”¹å‹•ã€‚

## å–œæ­¡å—ï¼Ÿ

å–œæ­¡çš„è©±å¯ä»¥åˆ†äº«å‡ºå»ï¼Œå¦‚æœä¸å–œæ­¡å°±â€¦â€¦ç®—äº†ï¼Œæˆ‘é‚„æ˜¯æœƒç¹¼çºŒå¯« ğŸ˜‚ã€‚
